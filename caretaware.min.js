/**
 * Copyright (c) 2015, Leo Di Donato <leodidonato@gmail.com>
 * caretaware.min.js - AngularJS directive for caret aware elements
 * @version 0.2.0
 * @link http://github.com/leodido/ng-caret-aware
 * @license MIT
 */
(function(){function m(f,e,n){function g(b){var a=(c.value||'').replace(/\r/g,'').length,d=~~b;0>d?d=a+b:d>a&&(d=a);return d}var c=e[0],l;e='setSelectionRange'in c||'selectionStart'in c;var q='createTextRange'in c||'selection'in document,a=this,h,k;switch(!0){case e:e=function(){return h().start};h=function(){var b=c.selectionStart,a=c.selectionEnd,d=a-b;return{start:b,end:a,length:d,text:c.value.substr(b,d)}};k=function(b){b=g(b);c.focus();c.setSelectionRange(b,b);f[a.a()]=b};break;case q:e=function(){c.focus();
var b=document.selection.createRange(),a=document.selection.createRange().text.length;b.moveStart('character',-c.value.length);return b.text.length-a};h=function(){c.focus();var b=document.selection.createRange(),a=c.createTextRange(),d=a.duplicate();a.moveToBookmark(b.getBookmark());d.setEndPoint('EndToStart',a);a=d.text.length;b=b.text;d=b.length;return{start:a,end:a+d,length:d,text:b}};k=function(b){b=g(b);var e=c.createTextRange();e.move('character',b);e.select();f[a.a()]=b};break;default:e=function(){return 0},
h=function(){return{start:0,end:0,length:0,text:''}},k=function(){}}a.a=function(){return l};a.c=function(b){if(!isNaN(parseFloat(b))&&isFinite(b))return k(b),a;throw new TypeError('Position MUST be numeric.');};a.b=e;a.getSelection=h;a.getPosition=a.b;a.getSelection=a.getSelection;a.setPosition=a.c;a.getNamespace=a.a;f.$watch(function(){return f[a.a()]},function(b){a.b()!==b&&a.c(b)});l=n.caretAware||'caret';f[l]=0}m.$inject=['$scope','$element','$attrs'];function p(){}p.prototype.link=function(f,e,n,g){e.on('keydown keyup click',function(){f.$evalAsync(function(){f[g.a()]=g.b()})})};angular.module('leodido.caretAware',[]).directive('caretAware',function(){var f=new p;return{restrict:'A',require:'caretAware',controller:m,link:f.link}});})();
