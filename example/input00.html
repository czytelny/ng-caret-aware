<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Angular caret aware elements</title>
</head>
<body ng-app="app">
  <div ng-controller="CursorController">
    <input type="tel" name="input00" id="input00" data-caret-aware="cursor"/>
    <button ng-click="cursor = cursor + 1"><b>+</b></button>
    <button ng-click="cursor = cursor - 1"><b>&ndash;</b></button>
    <button ng-click="printSelection()"><b>print selection</b></button>
  </div>
  <div>
    <pre id="selection"></pre>
  </div>

  <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.15/angular.js"></script> <!-- ../bower_components/angular/angular.js -->
  <script src="../dev.caretaware.min.js"></script>
  <script>
    angular.module('app', ['leodido.caretAware'])
      .controller('CursorController', ['$scope', function($scope) {
        var inputEl = angular.element(document.querySelector('#input00'));

        $scope.$watch('cursor', function(cursor) {
          console.log($scope);

          var caretAwareCtrl = inputEl.controller('caretAware');
          console.log('Position of caret named "cursor" (input element) changed: '+ cursor);
          console.log('Selection info: ', caretAwareCtrl.getSelection());
          // $scope.printSelection();
        });

        $scope.printSelection = function() {
          var caretAwareCtrl = inputEl.controller('caretAware');
          var selection = caretAwareCtrl.getSelection();
          var preEl = angular.element(document.querySelector('#selection'));
          preEl.text(JSON.stringify(selection));
        };
      }]);
  </script>
</body>
</html>
